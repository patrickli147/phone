{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\src\\components\\Camera.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\src\\components\\Camera.vue","mtime":1588931120909},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcE11dGF0aW9ucywgbWFwR2V0dGVyc30gZnJvbSAndnVleCc7DQppbXBvcnQgUGljdHVyZSBmcm9tICdAL2NvbXBvbmVudHMvUGljdHVyZSc7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ2NhbWVyYScsDQogIHByb3BzOiB7DQogICAgDQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgICB0cnkgew0KICAgICAgICAgIHRoaXMuZ2V0VXNlck1lZGlhKCk7DQogICAgICB9IGNhdGNoKGUpIHsNCiAgICAgICAgICBhbGVydCgi5omT5byA5pGE5YOP5aS05aSx6LSlISIpOw0KICAgICAgICAgIGNvbnNvbGUubG9nKGUpOw0KICAgICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAvL3RydWU6IHZpZGVvIGlzIHBsYXlpbmcNCiAgICAgICAgICBpc1ZpZGVvUGxheWluZzogZmFsc2UsDQogICAgICAgICAgLy9jb25zdHJhaW50cyBvZiBtZWRpYQ0KICAgICAgICAgIGNvbnN0cmFpbnRzOiB7DQogICAgICAgICAgICAgIGF1ZGlvOiBmYWxzZSwNCiAgICAgICAgICAgICAgdmlkZW86IHRydWUNCiAgICAgICAgICB9LA0KICAgICAgICAgIC8vc3JjIG9mIGltZw0KICAgICAgICAgIHNyYzonJywNCiAgICAgICAgICAvL2lzVmlkZW9Mb2FkZWQNCiAgICAgICAgICBpc1ZpZGVvTG9hZGVkOiBmYWxzZSwNCiAgICAgICAgICAvL2lzIHBpY3R1cmUgcHJldmlld2VkDQogICAgICAgICAgaXNQcmV2aWV3ZWQ6IGZhbHNlDQogICAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvL2dldCB1c2VyIG1lZGlhDQogICAgZ2V0VXNlck1lZGlhKCkgew0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh0aGlzLmNvbnN0cmFpbnRzKS50aGVuKChzdHJlYW0pID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cmVhbSk7DQogICAgICAgICAgICBsZXQgdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlkZW8iKTsNCiAgICAgICAgICAgIHZpZGVvLnNyY09iamVjdCA9IHN0cmVhbTsNCiAgICAgICAgICAgIHZpZGVvLm9ubG9hZGVkbWV0YWRhdGEgPSAoKSA9PiB7DQogICAgICAgICAgICAgICAgdmlkZW8ucGxheSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuaXNWaWRlb1BsYXlpbmcgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHRoaXMuaXNWaWRlb0xvYWRlZCA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy9oYW5kbGVUYWtlUGljdHVyZQ0KICAgIGhhbmRsZVRha2VQaWN0dXJlKCkgew0KICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOw0KICAgICAgICBsZXQgdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlkZW8iKTsNCiAgICAgICAgY2FudmFzLndpZHRoID0gdmlkZW8udmlkZW9XaWR0aDsNCiAgICAgICAgY2FudmFzLmhlaWdodCA9IHZpZGVvLnZpZGVvSGVpZ2h0Ow0KICAgICAgICBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKS5kcmF3SW1hZ2UodmlkZW8sIDAsIDApOw0KICAgICAgICB0aGlzLnNyYyA9IGNhbnZhcy50b0RhdGFVUkwoKTsNCg0KICAgICAgICAvL3NhdmUgdGhlIGltZyB0byBsb2NhbHN0b3JhZ2UNCiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLmdldFBpY3R1cmVOYW1lKCk7DQogICAgICAgIGxldCBjc3JjID0gdGhpcy5zcmM7DQogICAgICAgIGxldCBjdXJyZW50SW1nID0gew0KICAgICAgICAgICAgbmFtZSwNCiAgICAgICAgICAgIGNzcmMsDQogICAgICAgICAgICBpc0xpa2VkOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnJlbnRJbWcpOw0KICAgICAgICBsZXQgcGljdHVyZXMgPSB0aGlzLnBpY3R1cmVzOw0KICAgICAgICBwaWN0dXJlcy5wdXNoKGN1cnJlbnRJbWcpOw0KICAgICAgICB0aGlzLnVwZGF0ZVBpY3R1cmVzKHBpY3R1cmVzKTsNCiAgICB9LA0KICAgIC8vZ2V0IHBpY3R1cmUgbmFtZSBieSBjdXJyZW50IHRpbWUNCiAgICBnZXRQaWN0dXJlTmFtZSgpIHsNCiAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICBsZXQgbmFtZSA9IGRhdGUudG9KU09OKCk7DQogICAgICAgIHJldHVybiBuYW1lOw0KICAgIH0sDQogICAgLy9vcGVuIFBob3Rvcw0KICAgIG9wZW5QaWN0dXJlKCkgew0KICAgICAgICBpZiAodGhpcy5waWN0dXJlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIC8vbm8gcGljdHVyZSB0byBzaG93DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICB0aGlzLmlzUHJldmlld2VkID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLy9tYXAgbXV0YXRpb25zDQogICAgLi4ubWFwTXV0YXRpb25zKHsNCiAgICAgICAgdXBkYXRlUGljdHVyZXM6ICdVUERBVEVfUElDVFVSRVMnDQogICAgfSksDQogICAgLy9oYW5kbGVCYWNrSWNvbkNsaWNrZWQ6IHNldCBpc1ByZXZpZXdlZCB0byBmYWxzZQ0KICAgIGhhbmRsZUJhY2tJY29uQ2xpY2tlZCgpIHsNCiAgICAgICAgdGhpcy5pc1ByZXZpZXdlZCA9IGZhbHNlOw0KICAgIH0sDQogICAgLy9jYW5jZWwgZHJhZyBldmVudA0KICAgIGNhbmNlbERyYWcoZSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgfSwNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAgIC4uLm1hcEdldHRlcnMoWw0KICAgICAgICAgICdwaWN0dXJlcycNCiAgICAgIF0pLA0KICAgICAgLy9pbmRleCBvZiB0aGUgZmlyc3QgcGljdHVyZSBpbiBwaWN0dXJlcw0KICAgICAgaW5kZXhUb0dpdmUoKSB7DQogICAgICAgICAgcmV0dXJuIHRoaXMucGljdHVyZXMubGVuZ3RoIC0gMTsNCiAgICAgIH0sDQogICAgICAvL2N1cnJlbnQgc3JjIG9mIHNtYWxsIHBpY3R1cmUNCiAgICAgIGNzcmMoKSB7DQogICAgICAgICAgaWYgKHRoaXMucGljdHVyZXNbdGhpcy5pbmRleFRvR2l2ZV0pIHsNCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGljdHVyZXNbdGhpcy5pbmRleFRvR2l2ZV0uY3NyYzsNCiAgICAgICAgICB9DQogICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICB9DQogICAgICB9DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICAgIFBpY3R1cmUNCiAgfQ0KfQ0K"},{"version":3,"sources":["Camera.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Camera.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"camera\" v-show=\"isVideoLoaded\">\r\n        <div class=\"top-container\">\r\n            <video id=\"video\" v-show=\"isVideoPlaying\"></video>\r\n            <canvas id=\"canvas\"></canvas>\r\n            \r\n        </div>\r\n        <div class=\"bottom-container\">\r\n            <div class=\"small-picture\" @click=\"openPicture\" @dragstart=\"cancelDrag\">\r\n                <img v-show=\"pictures.length\" :src=\"csrc\" alt=\"img\">\r\n            </div>\r\n            <div class=\"take-picture-outline\">\r\n                <div class=\"take-picture\" @click=\"handleTakePicture\"></div>\r\n            </div>    \r\n            <div class=\"switchcamera\" @dragstart=\"cancelDrag\">\r\n                <img src=\"../assets/share_switchcamera.png\" alt=\"img\">\r\n            </div>\r\n        </div>  \r\n        <Picture :givenIndex=\"indexToGive\" :givenData=\"{name: '相机胶卷'}\" v-show=\"isPreviewed\" @backIconClicked=\"handleBackIconClicked\"></Picture>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapMutations, mapGetters} from 'vuex';\r\nimport Picture from '@/components/Picture';\r\n\r\nexport default {\r\n  name: 'camera',\r\n  props: {\r\n    \r\n  },\r\n  mounted() {\r\n      try {\r\n          this.getUserMedia();\r\n      } catch(e) {\r\n          alert(\"打开摄像头失败!\");\r\n          console.log(e);\r\n      }\r\n  },\r\n  data() {\r\n      return {\r\n          //true: video is playing\r\n          isVideoPlaying: false,\r\n          //constraints of media\r\n          constraints: {\r\n              audio: false,\r\n              video: true\r\n          },\r\n          //src of img\r\n          src:'',\r\n          //isVideoLoaded\r\n          isVideoLoaded: false,\r\n          //is picture previewed\r\n          isPreviewed: false\r\n      }\r\n  },\r\n  methods: {\r\n    //get user media\r\n    getUserMedia() {\r\n        navigator.mediaDevices.getUserMedia(this.constraints).then((stream) => {\r\n            console.log(stream);\r\n            let video = document.getElementById(\"video\");\r\n            video.srcObject = stream;\r\n            video.onloadedmetadata = () => {\r\n                video.play();\r\n                this.isVideoPlaying = true;\r\n                this.isVideoLoaded = true;\r\n            }\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        });\r\n    },\r\n    //handleTakePicture\r\n    handleTakePicture() {\r\n        let canvas = document.getElementById(\"canvas\");\r\n        let video = document.getElementById(\"video\");\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        canvas.getContext('2d').drawImage(video, 0, 0);\r\n        this.src = canvas.toDataURL();\r\n\r\n        //save the img to localstorage\r\n        let name = this.getPictureName();\r\n        let csrc = this.src;\r\n        let currentImg = {\r\n            name,\r\n            csrc,\r\n            isLiked: false\r\n        };\r\n        //console.log(currentImg);\r\n        let pictures = this.pictures;\r\n        pictures.push(currentImg);\r\n        this.updatePictures(pictures);\r\n    },\r\n    //get picture name by current time\r\n    getPictureName() {\r\n        let date = new Date();\r\n        let name = date.toJSON();\r\n        return name;\r\n    },\r\n    //open Photos\r\n    openPicture() {\r\n        if (this.pictures.length === 0) {\r\n            //no picture to show\r\n            return;\r\n        }\r\n        else {\r\n            this.isPreviewed = true;\r\n        }\r\n    },\r\n    //map mutations\r\n    ...mapMutations({\r\n        updatePictures: 'UPDATE_PICTURES'\r\n    }),\r\n    //handleBackIconClicked: set isPreviewed to false\r\n    handleBackIconClicked() {\r\n        this.isPreviewed = false;\r\n    },\r\n    //cancel drag event\r\n    cancelDrag(e) {\r\n        e.preventDefault();\r\n    },\r\n  },\r\n  computed: {\r\n      ...mapGetters([\r\n          'pictures'\r\n      ]),\r\n      //index of the first picture in pictures\r\n      indexToGive() {\r\n          return this.pictures.length - 1;\r\n      },\r\n      //current src of small picture\r\n      csrc() {\r\n          if (this.pictures[this.indexToGive]) {\r\n              return this.pictures[this.indexToGive].csrc;\r\n          }\r\n          else {\r\n              return '';\r\n          }\r\n      }\r\n  },\r\n  components: {\r\n      Picture\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style lang=\"scss\" scoped>\r\n.camera {\r\n    height: 100%;\r\n    width: 100%;\r\n    background-color: #000;\r\n    position: relative;\r\n\r\n    .top-container {\r\n        width: 100%;\r\n        height: 85%;\r\n\r\n        video {\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n\r\n        canvas {\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .bottom-container {\r\n\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .small-picture {\r\n            width: 40px;\r\n            height: 40px;\r\n            background-color: #333;\r\n\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n\r\n        .take-picture-outline {\r\n            width: 50px;\r\n            height: 50px;\r\n            border-radius: 50%;\r\n            border: 3px solid #fff;\r\n            \r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            .take-picture {\r\n                background-color: #fff;\r\n                width: 40px;\r\n                height: 40px;\r\n                box-sizing: content-box;\r\n                border-radius: 50%;\r\n            }\r\n        }\r\n        \r\n        .switchcamera {\r\n            width: 40px;\r\n            height: 40px;\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>"]}]}