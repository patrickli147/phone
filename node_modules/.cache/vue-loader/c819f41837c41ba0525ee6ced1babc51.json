{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\src\\components\\Camera.vue?vue&type=style&index=0&id=74104ed5&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\src\\components\\Camera.vue","mtime":1588931120909},{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\demos\\iphone\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmNhbWVyYSB7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDA7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KDQogICAgLnRvcC1jb250YWluZXIgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgaGVpZ2h0OiA4NSU7DQoNCiAgICAgICAgdmlkZW8gew0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgIH0NCg0KICAgICAgICBjYW52YXMgew0KICAgICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC5ib3R0b20tY29udGFpbmVyIHsNCg0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQoNCiAgICAgICAgLnNtYWxsLXBpY3R1cmUgew0KICAgICAgICAgICAgd2lkdGg6IDQwcHg7DQogICAgICAgICAgICBoZWlnaHQ6IDQwcHg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzMzOw0KDQogICAgICAgICAgICBpbWcgew0KICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC50YWtlLXBpY3R1cmUtb3V0bGluZSB7DQogICAgICAgICAgICB3aWR0aDogNTBweDsNCiAgICAgICAgICAgIGhlaWdodDogNTBweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICAgICAgICAgIGJvcmRlcjogM3B4IHNvbGlkICNmZmY7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICAudGFrZS1waWN0dXJlIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOw0KICAgICAgICAgICAgICAgIHdpZHRoOiA0MHB4Ow0KICAgICAgICAgICAgICAgIGhlaWdodDogNDBweDsNCiAgICAgICAgICAgICAgICBib3gtc2l6aW5nOiBjb250ZW50LWJveDsNCiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC5zd2l0Y2hjYW1lcmEgew0KICAgICAgICAgICAgd2lkdGg6IDQwcHg7DQogICAgICAgICAgICBoZWlnaHQ6IDQwcHg7DQogICAgICAgICAgICBpbWcgew0KICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["Camera.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Camera.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"camera\" v-show=\"isVideoLoaded\">\r\n        <div class=\"top-container\">\r\n            <video id=\"video\" v-show=\"isVideoPlaying\"></video>\r\n            <canvas id=\"canvas\"></canvas>\r\n            \r\n        </div>\r\n        <div class=\"bottom-container\">\r\n            <div class=\"small-picture\" @click=\"openPicture\" @dragstart=\"cancelDrag\">\r\n                <img v-show=\"pictures.length\" :src=\"csrc\" alt=\"img\">\r\n            </div>\r\n            <div class=\"take-picture-outline\">\r\n                <div class=\"take-picture\" @click=\"handleTakePicture\"></div>\r\n            </div>    \r\n            <div class=\"switchcamera\" @dragstart=\"cancelDrag\">\r\n                <img src=\"../assets/share_switchcamera.png\" alt=\"img\">\r\n            </div>\r\n        </div>  \r\n        <Picture :givenIndex=\"indexToGive\" :givenData=\"{name: '相机胶卷'}\" v-show=\"isPreviewed\" @backIconClicked=\"handleBackIconClicked\"></Picture>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapMutations, mapGetters} from 'vuex';\r\nimport Picture from '@/components/Picture';\r\n\r\nexport default {\r\n  name: 'camera',\r\n  props: {\r\n    \r\n  },\r\n  mounted() {\r\n      try {\r\n          this.getUserMedia();\r\n      } catch(e) {\r\n          alert(\"打开摄像头失败!\");\r\n          console.log(e);\r\n      }\r\n  },\r\n  data() {\r\n      return {\r\n          //true: video is playing\r\n          isVideoPlaying: false,\r\n          //constraints of media\r\n          constraints: {\r\n              audio: false,\r\n              video: true\r\n          },\r\n          //src of img\r\n          src:'',\r\n          //isVideoLoaded\r\n          isVideoLoaded: false,\r\n          //is picture previewed\r\n          isPreviewed: false\r\n      }\r\n  },\r\n  methods: {\r\n    //get user media\r\n    getUserMedia() {\r\n        navigator.mediaDevices.getUserMedia(this.constraints).then((stream) => {\r\n            console.log(stream);\r\n            let video = document.getElementById(\"video\");\r\n            video.srcObject = stream;\r\n            video.onloadedmetadata = () => {\r\n                video.play();\r\n                this.isVideoPlaying = true;\r\n                this.isVideoLoaded = true;\r\n            }\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        });\r\n    },\r\n    //handleTakePicture\r\n    handleTakePicture() {\r\n        let canvas = document.getElementById(\"canvas\");\r\n        let video = document.getElementById(\"video\");\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        canvas.getContext('2d').drawImage(video, 0, 0);\r\n        this.src = canvas.toDataURL();\r\n\r\n        //save the img to localstorage\r\n        let name = this.getPictureName();\r\n        let csrc = this.src;\r\n        let currentImg = {\r\n            name,\r\n            csrc,\r\n            isLiked: false\r\n        };\r\n        //console.log(currentImg);\r\n        let pictures = this.pictures;\r\n        pictures.push(currentImg);\r\n        this.updatePictures(pictures);\r\n    },\r\n    //get picture name by current time\r\n    getPictureName() {\r\n        let date = new Date();\r\n        let name = date.toJSON();\r\n        return name;\r\n    },\r\n    //open Photos\r\n    openPicture() {\r\n        if (this.pictures.length === 0) {\r\n            //no picture to show\r\n            return;\r\n        }\r\n        else {\r\n            this.isPreviewed = true;\r\n        }\r\n    },\r\n    //map mutations\r\n    ...mapMutations({\r\n        updatePictures: 'UPDATE_PICTURES'\r\n    }),\r\n    //handleBackIconClicked: set isPreviewed to false\r\n    handleBackIconClicked() {\r\n        this.isPreviewed = false;\r\n    },\r\n    //cancel drag event\r\n    cancelDrag(e) {\r\n        e.preventDefault();\r\n    },\r\n  },\r\n  computed: {\r\n      ...mapGetters([\r\n          'pictures'\r\n      ]),\r\n      //index of the first picture in pictures\r\n      indexToGive() {\r\n          return this.pictures.length - 1;\r\n      },\r\n      //current src of small picture\r\n      csrc() {\r\n          if (this.pictures[this.indexToGive]) {\r\n              return this.pictures[this.indexToGive].csrc;\r\n          }\r\n          else {\r\n              return '';\r\n          }\r\n      }\r\n  },\r\n  components: {\r\n      Picture\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style lang=\"scss\" scoped>\r\n.camera {\r\n    height: 100%;\r\n    width: 100%;\r\n    background-color: #000;\r\n    position: relative;\r\n\r\n    .top-container {\r\n        width: 100%;\r\n        height: 85%;\r\n\r\n        video {\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n\r\n        canvas {\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .bottom-container {\r\n\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .small-picture {\r\n            width: 40px;\r\n            height: 40px;\r\n            background-color: #333;\r\n\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n\r\n        .take-picture-outline {\r\n            width: 50px;\r\n            height: 50px;\r\n            border-radius: 50%;\r\n            border: 3px solid #fff;\r\n            \r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            .take-picture {\r\n                background-color: #fff;\r\n                width: 40px;\r\n                height: 40px;\r\n                box-sizing: content-box;\r\n                border-radius: 50%;\r\n            }\r\n        }\r\n        \r\n        .switchcamera {\r\n            width: 40px;\r\n            height: 40px;\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>"]}]}