{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\src\\components\\Camera.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\src\\components\\Camera.vue","mtime":1588931120909},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\新建文件夹\\phone\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC50by1qc29uIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzpcXFVzZXJzXFxMZW5vdm9cXERlc2t0b3BcXFx1NjVCMFx1NUVGQVx1NjU4N1x1NEVGNlx1NTkzOVxccGhvbmVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBtYXBNdXRhdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IFBpY3R1cmUgZnJvbSAnQC9jb21wb25lbnRzL1BpY3R1cmUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2NhbWVyYScsCiAgcHJvcHM6IHt9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0cnkgewogICAgICB0aGlzLmdldFVzZXJNZWRpYSgpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBhbGVydCgi5omT5byA5pGE5YOP5aS05aSx6LSlISIpOwogICAgICBjb25zb2xlLmxvZyhlKTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvL3RydWU6IHZpZGVvIGlzIHBsYXlpbmcKICAgICAgaXNWaWRlb1BsYXlpbmc6IGZhbHNlLAogICAgICAvL2NvbnN0cmFpbnRzIG9mIG1lZGlhCiAgICAgIGNvbnN0cmFpbnRzOiB7CiAgICAgICAgYXVkaW86IGZhbHNlLAogICAgICAgIHZpZGVvOiB0cnVlCiAgICAgIH0sCiAgICAgIC8vc3JjIG9mIGltZwogICAgICBzcmM6ICcnLAogICAgICAvL2lzVmlkZW9Mb2FkZWQKICAgICAgaXNWaWRlb0xvYWRlZDogZmFsc2UsCiAgICAgIC8vaXMgcGljdHVyZSBwcmV2aWV3ZWQKICAgICAgaXNQcmV2aWV3ZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogX29iamVjdFNwcmVhZCh7CiAgICAvL2dldCB1c2VyIG1lZGlhCiAgICBnZXRVc2VyTWVkaWE6IGZ1bmN0aW9uIGdldFVzZXJNZWRpYSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHRoaXMuY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgIGNvbnNvbGUubG9nKHN0cmVhbSk7CiAgICAgICAgdmFyIHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZGVvIik7CiAgICAgICAgdmlkZW8uc3JjT2JqZWN0ID0gc3RyZWFtOwoKICAgICAgICB2aWRlby5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmlkZW8ucGxheSgpOwogICAgICAgICAgX3RoaXMuaXNWaWRlb1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgX3RoaXMuaXNWaWRlb0xvYWRlZCA9IHRydWU7CiAgICAgICAgfTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0pOwogICAgfSwKICAgIC8vaGFuZGxlVGFrZVBpY3R1cmUKICAgIGhhbmRsZVRha2VQaWN0dXJlOiBmdW5jdGlvbiBoYW5kbGVUYWtlUGljdHVyZSgpIHsKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsKICAgICAgdmFyIHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZGVvIik7CiAgICAgIGNhbnZhcy53aWR0aCA9IHZpZGVvLnZpZGVvV2lkdGg7CiAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWRlby52aWRlb0hlaWdodDsKICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJykuZHJhd0ltYWdlKHZpZGVvLCAwLCAwKTsKICAgICAgdGhpcy5zcmMgPSBjYW52YXMudG9EYXRhVVJMKCk7IC8vc2F2ZSB0aGUgaW1nIHRvIGxvY2Fsc3RvcmFnZQoKICAgICAgdmFyIG5hbWUgPSB0aGlzLmdldFBpY3R1cmVOYW1lKCk7CiAgICAgIHZhciBjc3JjID0gdGhpcy5zcmM7CiAgICAgIHZhciBjdXJyZW50SW1nID0gewogICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgY3NyYzogY3NyYywKICAgICAgICBpc0xpa2VkOiBmYWxzZQogICAgICB9OyAvL2NvbnNvbGUubG9nKGN1cnJlbnRJbWcpOwoKICAgICAgdmFyIHBpY3R1cmVzID0gdGhpcy5waWN0dXJlczsKICAgICAgcGljdHVyZXMucHVzaChjdXJyZW50SW1nKTsKICAgICAgdGhpcy51cGRhdGVQaWN0dXJlcyhwaWN0dXJlcyk7CiAgICB9LAogICAgLy9nZXQgcGljdHVyZSBuYW1lIGJ5IGN1cnJlbnQgdGltZQogICAgZ2V0UGljdHVyZU5hbWU6IGZ1bmN0aW9uIGdldFBpY3R1cmVOYW1lKCkgewogICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgIHZhciBuYW1lID0gZGF0ZS50b0pTT04oKTsKICAgICAgcmV0dXJuIG5hbWU7CiAgICB9LAogICAgLy9vcGVuIFBob3RvcwogICAgb3BlblBpY3R1cmU6IGZ1bmN0aW9uIG9wZW5QaWN0dXJlKCkgewogICAgICBpZiAodGhpcy5waWN0dXJlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAvL25vIHBpY3R1cmUgdG8gc2hvdwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzUHJldmlld2VkID0gdHJ1ZTsKICAgICAgfQogICAgfQogIH0sIG1hcE11dGF0aW9ucyh7CiAgICB1cGRhdGVQaWN0dXJlczogJ1VQREFURV9QSUNUVVJFUycKICB9KSwgewogICAgLy9oYW5kbGVCYWNrSWNvbkNsaWNrZWQ6IHNldCBpc1ByZXZpZXdlZCB0byBmYWxzZQogICAgaGFuZGxlQmFja0ljb25DbGlja2VkOiBmdW5jdGlvbiBoYW5kbGVCYWNrSWNvbkNsaWNrZWQoKSB7CiAgICAgIHRoaXMuaXNQcmV2aWV3ZWQgPSBmYWxzZTsKICAgIH0sCiAgICAvL2NhbmNlbCBkcmFnIGV2ZW50CiAgICBjYW5jZWxEcmFnOiBmdW5jdGlvbiBjYW5jZWxEcmFnKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQogIH0pLAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsncGljdHVyZXMnXSksIHsKICAgIC8vaW5kZXggb2YgdGhlIGZpcnN0IHBpY3R1cmUgaW4gcGljdHVyZXMKICAgIGluZGV4VG9HaXZlOiBmdW5jdGlvbiBpbmRleFRvR2l2ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGljdHVyZXMubGVuZ3RoIC0gMTsKICAgIH0sCiAgICAvL2N1cnJlbnQgc3JjIG9mIHNtYWxsIHBpY3R1cmUKICAgIGNzcmM6IGZ1bmN0aW9uIGNzcmMoKSB7CiAgICAgIGlmICh0aGlzLnBpY3R1cmVzW3RoaXMuaW5kZXhUb0dpdmVdKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGljdHVyZXNbdGhpcy5pbmRleFRvR2l2ZV0uY3NyYzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KICAgIH0KICB9KSwKICBjb21wb25lbnRzOiB7CiAgICBQaWN0dXJlOiBQaWN0dXJlCiAgfQp9Ow=="},{"version":3,"sources":["Camera.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div class=\"camera\" v-show=\"isVideoLoaded\">\r\n        <div class=\"top-container\">\r\n            <video id=\"video\" v-show=\"isVideoPlaying\"></video>\r\n            <canvas id=\"canvas\"></canvas>\r\n            \r\n        </div>\r\n        <div class=\"bottom-container\">\r\n            <div class=\"small-picture\" @click=\"openPicture\" @dragstart=\"cancelDrag\">\r\n                <img v-show=\"pictures.length\" :src=\"csrc\" alt=\"img\">\r\n            </div>\r\n            <div class=\"take-picture-outline\">\r\n                <div class=\"take-picture\" @click=\"handleTakePicture\"></div>\r\n            </div>    \r\n            <div class=\"switchcamera\" @dragstart=\"cancelDrag\">\r\n                <img src=\"../assets/share_switchcamera.png\" alt=\"img\">\r\n            </div>\r\n        </div>  \r\n        <Picture :givenIndex=\"indexToGive\" :givenData=\"{name: '相机胶卷'}\" v-show=\"isPreviewed\" @backIconClicked=\"handleBackIconClicked\"></Picture>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapMutations, mapGetters} from 'vuex';\r\nimport Picture from '@/components/Picture';\r\n\r\nexport default {\r\n  name: 'camera',\r\n  props: {\r\n    \r\n  },\r\n  mounted() {\r\n      try {\r\n          this.getUserMedia();\r\n      } catch(e) {\r\n          alert(\"打开摄像头失败!\");\r\n          console.log(e);\r\n      }\r\n  },\r\n  data() {\r\n      return {\r\n          //true: video is playing\r\n          isVideoPlaying: false,\r\n          //constraints of media\r\n          constraints: {\r\n              audio: false,\r\n              video: true\r\n          },\r\n          //src of img\r\n          src:'',\r\n          //isVideoLoaded\r\n          isVideoLoaded: false,\r\n          //is picture previewed\r\n          isPreviewed: false\r\n      }\r\n  },\r\n  methods: {\r\n    //get user media\r\n    getUserMedia() {\r\n        navigator.mediaDevices.getUserMedia(this.constraints).then((stream) => {\r\n            console.log(stream);\r\n            let video = document.getElementById(\"video\");\r\n            video.srcObject = stream;\r\n            video.onloadedmetadata = () => {\r\n                video.play();\r\n                this.isVideoPlaying = true;\r\n                this.isVideoLoaded = true;\r\n            }\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        });\r\n    },\r\n    //handleTakePicture\r\n    handleTakePicture() {\r\n        let canvas = document.getElementById(\"canvas\");\r\n        let video = document.getElementById(\"video\");\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        canvas.getContext('2d').drawImage(video, 0, 0);\r\n        this.src = canvas.toDataURL();\r\n\r\n        //save the img to localstorage\r\n        let name = this.getPictureName();\r\n        let csrc = this.src;\r\n        let currentImg = {\r\n            name,\r\n            csrc,\r\n            isLiked: false\r\n        };\r\n        //console.log(currentImg);\r\n        let pictures = this.pictures;\r\n        pictures.push(currentImg);\r\n        this.updatePictures(pictures);\r\n    },\r\n    //get picture name by current time\r\n    getPictureName() {\r\n        let date = new Date();\r\n        let name = date.toJSON();\r\n        return name;\r\n    },\r\n    //open Photos\r\n    openPicture() {\r\n        if (this.pictures.length === 0) {\r\n            //no picture to show\r\n            return;\r\n        }\r\n        else {\r\n            this.isPreviewed = true;\r\n        }\r\n    },\r\n    //map mutations\r\n    ...mapMutations({\r\n        updatePictures: 'UPDATE_PICTURES'\r\n    }),\r\n    //handleBackIconClicked: set isPreviewed to false\r\n    handleBackIconClicked() {\r\n        this.isPreviewed = false;\r\n    },\r\n    //cancel drag event\r\n    cancelDrag(e) {\r\n        e.preventDefault();\r\n    },\r\n  },\r\n  computed: {\r\n      ...mapGetters([\r\n          'pictures'\r\n      ]),\r\n      //index of the first picture in pictures\r\n      indexToGive() {\r\n          return this.pictures.length - 1;\r\n      },\r\n      //current src of small picture\r\n      csrc() {\r\n          if (this.pictures[this.indexToGive]) {\r\n              return this.pictures[this.indexToGive].csrc;\r\n          }\r\n          else {\r\n              return '';\r\n          }\r\n      }\r\n  },\r\n  components: {\r\n      Picture\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style lang=\"scss\" scoped>\r\n.camera {\r\n    height: 100%;\r\n    width: 100%;\r\n    background-color: #000;\r\n    position: relative;\r\n\r\n    .top-container {\r\n        width: 100%;\r\n        height: 85%;\r\n\r\n        video {\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n\r\n        canvas {\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .bottom-container {\r\n\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .small-picture {\r\n            width: 40px;\r\n            height: 40px;\r\n            background-color: #333;\r\n\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n\r\n        .take-picture-outline {\r\n            width: 50px;\r\n            height: 50px;\r\n            border-radius: 50%;\r\n            border: 3px solid #fff;\r\n            \r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            .take-picture {\r\n                background-color: #fff;\r\n                width: 40px;\r\n                height: 40px;\r\n                box-sizing: content-box;\r\n                border-radius: 50%;\r\n            }\r\n        }\r\n        \r\n        .switchcamera {\r\n            width: 40px;\r\n            height: 40px;\r\n            img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>"],"sourceRoot":"src/components"}]}